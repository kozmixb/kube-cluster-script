{
  "metadata": {
    "name": "confnginx"
  },
  "data": {
    "nginx.conf": "user  nginx;\nworker_processes  1;\nerror_log  /var/log/nginx/error.log warn;\npid        /var/run/nginx.pid;\nevents {\n    worker_connections  1024;\n}\nhttp {\n  include       /etc/nginx/mime.types;\n  default_type  application/octet-stream;\n  log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n                      '$status $body_bytes_sent \"$http_referer\" '\n                      '\"$http_user_agent\" \"$http_x_forwarded_for\"';\n  access_log  /var/log/nginx/access.log  main;\n  sendfile        on;\n  keepalive_timeout  65;\n  server {\n    listen 80;\n\n    server_name ~^(?<subdomain>.*?)\\.;\n    resolver kube-dns.kube-system.svc.cluster.local valid=5s;\n\n    location /healthz {\n      return 200;\n    }\n\n    location / {\n      proxy_set_header Upgrade $http_upgrade;\n      proxy_set_header Connection \"Upgrade\";\n      proxy_pass http://$subdomain.msce0.svc.cluster.local;\n      proxy_set_header Host $host;\n      proxy_http_version 1.1;\n    }\n  }\n}\n"
  }
}